<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RS TECH</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css">
  <style>
    :root {
      --c-cyan:   #19fff7;
      --c-green:  #46ff86;
      --c-yellow: #ffe066;
      --c-blue:   #02a6ff;
      --c-purple: #977cff;
      --c-bg-dark:#16271d;
      --c-bg-card:#193c2c;
      --txt: #eaffea;
      --tit: 'Orbitron', Arial, sans-serif;
      --bod: 'Share Tech Mono', monospace;
    }
    body {
      background: linear-gradient(120deg, #16271d 0%, #1b3440 100%);
      color: var(--txt);
      font-family: var(--bod);
      margin: 0;
      padding: 0 0 0 70px;
      min-height: 100vh;
      box-sizing: border-box;
      position: relative;
      overflow-x: hidden;
    }
    header {
      background: transparent;
      color: var(--c-green);
      text-align: center;
      padding: 2.2rem 1rem 1.2rem 1rem;
      font-family: var(--tit);
      font-size: 2.2rem;
      font-weight: bold;
      letter-spacing: 2px;
      text-shadow: 0 2px 12px var(--c-cyan);
      border-bottom: 3px solid var(--c-cyan);
      z-index: 10;
      position: relative;
    }
    .atalhos-lateral {
      position: fixed;
      top: 0; left: 0;
      width: 70px;
      height: 100vh;
      background: #153826;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.6rem; /* Espaçamento padrão para telas maiores */
      z-index: 99;
      box-shadow: 2px 0 14px #19fff733;
      padding-top: 1.2rem; /* Mantém um padding no topo */
      padding-bottom: 1.2rem; /* Adiciona um padding na base para respiro se houver scroll */
      overflow-y: auto;
      overflow-x: hidden;
      border-right: 2px solid var(--c-green);
      scrollbar-width: thin;
      scrollbar-color: var(--c-green) #153826;
      overscroll-behavior-y: contain;
      /* touch-action: pan-y; */
      /* -webkit-overflow-scrolling: touch; */
    }
    .atalhos-lateral .ataho-link {
      width: 44px; height: 44px;
      margin: 0.16rem 0; /* Margem padrão para telas maiores */
      background: #143a22;
      color: var(--c-cyan);
      display: flex; align-items: center; justify-content: center;
      border-radius: 10px; font-size: 1.22rem;
      border: 1.5px solid transparent;
      transition: border .2s, color .2s, box-shadow .2s, transform .2s;
      outline: none;
      flex-shrink: 0; /* Para evitar que os ícones encolham */
    }
    .atalhos-lateral .ataho-link:focus {
      outline: 2px solid var(--c-yellow);
      outline-offset: 2px;
    }
    .atalhos-lateral .ataho-link:hover, .atalhos-lateral .ataho-link:focus {
      color: var(--c-yellow);
      border: 1.5px solid var(--c-yellow);
      box-shadow: 0 0 10px var(--c-yellow);
      transform: scale(1.1); /* Efeito de leve zoom ao interagir */
    }
    .atalhos-lateral .ataho-link.active {
      color: var(--c-green);
      border: 1.5px solid var(--c-green);
      box-shadow: 0 0 14px var(--c-green);
    }
    .atalhos-lateral::-webkit-scrollbar {
      width: 8px;
      background: #153826;
    }
    .atalhos-lateral::-webkit-scrollbar-thumb {
      background: var(--c-green);
      border-radius: 4px;
    }

    @media (max-width: 800px) {
      .atalhos-lateral {
        width: 54px;
        gap: 0.3rem; /* Reduzindo o espaçamento entre os ícones */
        padding-top: 0.8rem; /* Ajustando padding no topo para telas menores */
        padding-bottom: 0.8rem; /* Ajustando padding na base para telas menores */
      }
      body { padding-left: 54px; }
      .atalhos-lateral .ataho-link {
        width: 36px;
        height: 36px;
        margin: 0.1rem 0; /* Reduzindo a margem vertical dos ícones */
        font-size: 1.1rem; /* Opcional: reduzir um pouco o tamanho do ícone */
      }
    }

    @media (max-width: 600px) {
      .atalhos-lateral {
        width: 50px;
        gap: 0.2rem; /* Reduzindo ainda mais o espaçamento */
        padding-top: 0.6rem; /* Ajustando padding no topo */
        padding-bottom: 0.6rem; /* Ajustando padding na base */
      }
      body { padding-left: 50px; }
      .atalhos-lateral .ataho-link {
        width: 30px;
        height: 30px;
        margin: 0.05rem 0; /* Reduzindo ainda mais a margem vertical */
        font-size: 1rem; /* Opcional: reduzir mais o tamanho do ícone */
      }
    }
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 2rem;
      padding: 2rem 2vw 1rem 2vw;
      max-width: 1440px;
      margin: auto;
      box-sizing: border-box;
    }
    @media (max-width: 1100px) {
      .dashboard-grid { grid-template-columns: 1fr 1fr; gap: 1.1rem; }
    }
    @media (max-width: 800px) { /* Alterado de 800px para 799px para não colidir com a media query anterior se houver sobreposição */
      .dashboard-grid { grid-template-columns: 1fr; gap: 1.1rem; }
    }
    @media (max-width: 599px) { /* Alterado de 600px para 599px */
      .dashboard-grid { gap: 0.5rem; padding: 0.5rem 0.1rem; }
    }
    .card {
      background: var(--c-bg-card);
      border-radius: 1.5rem;
      box-shadow: 0 2px 18px #19fff733;
      padding: 1.4rem 1.1rem 1.1rem 1.1rem;
      display: flex;
      flex-direction: column;
      min-width: 220px;
      max-width: 100%;
      min-height: 340px;
      margin-bottom: 0.5rem;
      border: 2px solid var(--c-green);
      transition: border .16s, box-shadow .14s;
      overflow: visible;
      box-sizing: border-box;
    }
    .card h2 {
      font-family: var(--tit);
      font-size: 1.14rem;
      color: var(--c-cyan);
      letter-spacing: 1px;
      margin: 0 0 1rem 0;
      text-align: center;
      border-bottom: 1.5px solid var(--c-yellow);
      padding-bottom: 0.5rem;
    }
    .card form,
    .card textarea,
    .card input,
    .card select {
      width: 100%;
      box-sizing: border-box;
    }
    input, textarea, select {
      width: 100%;
      max-width: 100%;
      box-sizing: border-box;
      display: block;
      border-radius: 0.7rem;
      background: #163221;
      color: var(--txt);
      border: 1.5px solid var(--c-green);
      padding: 0.8rem 1rem;
      margin: 0.2rem 0 0.6rem 0;
      font-size: 1.06rem;
      font-family: var(--bod);
      transition: border 0.13s;
      outline: none;
      word-break: break-all;
    }
    .diario-classe form {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .cadastro-alunos form {
      display: flex;
      flex-direction: column;
      gap: 0.3rem;
      align-items: stretch;
    }
    .cadastro-alunos .alunos-btns {
      display: flex;
      justify-content: center;
      gap: 0.7rem;
      margin: 0.4rem 0 0.4rem 0;
    }
    .cadastro-alunos .btn {
      min-width: 120px;
    }
    textarea {
      resize: vertical;
      min-height: 74px;
      max-height: 220px;
      overflow-y: auto;
    }
    input:focus, textarea:focus, select:focus {
      border: 1.5px solid var(--c-yellow);
    }
    .card form .btn {
      margin-right: 0.6rem;
      margin-bottom: 0.4rem;
      margin-top: 0.2rem;
    }
    .card form .btn:last-child {
      margin-right: 0;
    }
    .table-actions button {
      background: none;
      border: none;
      color: var(--c-green);
      font-size: 1.13rem;
      cursor: pointer;
      transition: color 0.14s;
    }
    .table-actions button:hover { color: var(--c-yellow); }
    table {
      width: 100%;
      border-collapse: collapse;
      background: #133829;
      color: var(--txt);
      border-radius: 1rem;
      margin-bottom: 1rem;
      font-size: 0.97rem;
      box-shadow: 0 1px 6px #19fff722;
      overflow: hidden; /* Garante que o border-radius da tabela seja respeitado pelos filhos */
      box-sizing: border-box;
    }
    th, td {
      padding: 0.6rem 0.4rem;
      text-align: left;
      border-bottom: 1px solid #263b2b;
    }
    th {
      color: var(--c-green);
      font-family: var(--tit);
      border-bottom: 2px solid var(--c-cyan);
    }
    .portal-acesso {
      background: transparent;
      color: var(--c-green);
      border-radius: 1.2rem;
      border: 2px solid var(--c-cyan);
      font-family: var(--tit);
      text-align: center;
      font-size: 1.08rem;
      font-weight: bold;
      box-shadow: 0 2px 12px #19fff733;
      padding: 2rem 1rem;
      margin: 2rem auto 1.5rem auto;
      max-width: 700px;
      transition: border .19s, color .19s;
      cursor: pointer;
      text-decoration: none;
      letter-spacing: 1.15px;
      display: block;
    }
    .portal-acesso:hover { color: var(--c-yellow); border-color: var(--c-yellow);}
    .main-controls {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 2.1rem;
      margin: 2.5rem auto 0 auto;
      padding-bottom: calc(3.7rem + 40px); /* Aumentado para acomodar o footer mais alto */
      max-width: 700px;
      width: 100%;
    }
    .btn-export, .btn-import, .btn {
      background: transparent;
      color: var(--c-cyan);
      font-family: var(--tit);
      border: 1.5px solid var(--c-cyan);
      border-radius: 1.1rem;
      padding: 0.7rem 1.6rem;
      font-size: 1.06rem;
      font-weight: bold;
      cursor: pointer;
      transition: border .14s, color .14s, background .14s;
      margin-top: 0.2rem;
    }
    .btn-export:hover, .btn-import:hover, .btn:hover {
      color: var(--c-green);
      border: 1.5px solid var(--c-green);
      background: #1d342a;
    }
    footer {
      width: 100vw; /* Usa 100vw para cobrir a largura da viewport */
      text-align: center;
      color: #5beebb;
      font-size: 1.1rem;
      font-family: var(--tit);
      letter-spacing: 0.2em;
      background: #133829ea;
      padding: 0.85rem 0; /* Removido padding-bottom específico, já é 0.85rem geral */
      position: fixed;
      left: 0;
      bottom: 0;
      z-index: 100;
      opacity: 0.85;
      user-select: none;
      box-shadow: 0 -2px 8px #16271d77;
      box-sizing: border-box; /* Inclui padding na largura total */
    }
    @media (max-width: 600px) {
      .main-controls { flex-direction: column; gap: 1.2rem; padding-bottom: calc(4.7rem + 35px); } /* Ajuste para footer */
      .portal-acesso { font-size: 1rem; padding: 1.3rem 0.6rem;}
      footer { font-size: 0.99rem; padding: 0.65rem 0; }
    }
    @media (max-width: 480px) {
      .card { padding: 1.1rem 0.2rem 0.8rem 0.2rem; }
      .dashboard-grid { padding: 0.6rem 0.1rem; }
      .main-controls { padding-bottom: calc(6rem + 35px); } /* Ajuste para footer */
    }
    /* Modal Diário de Classe, Controle Financeiro, Cadastro de Alunos */
    .modal-bg {
      display: none;
      position: fixed;
      z-index: 1010;
      left: 0; top: 0; width: 100vw; height: 100vh;
      background: rgba(0,32,32,0.72);
      justify-content: center;
      align-items: center;
      padding: 1rem; /* Adiciona um respiro para a modal não colar nas bordas */
      box-sizing: border-box;
    }
    .modal-bg.active { display: flex; }
    .modal-diario, .modal-financeiro, .modal-alunos {
      background: #122921;
      color: var(--txt);
      border-radius: 1.1rem;
      box-shadow: 0 8px 34px #1beeea66;
      padding: 2.3rem 2rem 1.7rem 2rem;
      min-width: 300px; 
      width: 100%; /* Ocupa a largura disponível dentro do padding do modal-bg */
      max-width: 800px; /* Limita a largura máxima da modal */
      max-height: calc(100vh - 2rem); /* Ajusta a altura máxima considerando o padding do modal-bg */
      font-family: var(--bod);
      font-size: 1.13rem;
      display: flex;
      flex-direction: column;
      gap: 1.2rem;
      position: relative;
      overflow-y: auto; 
      overscroll-behavior-y: contain; 
    }
    .modal-diario h3,
    .modal-financeiro h3,
    .modal-alunos h3 {
      margin: 0 0 1.3rem 0;
      text-align: center;
      font-family: var(--tit);
      color: var(--c-cyan);
    }
    .modal-diario .fechar-modal,
    .modal-financeiro .fechar-modal,
    .modal-alunos .fechar-modal {
      position: absolute;
      right: 18px; top: 12px;
      background: none;
      border: none;
      color: var(--c-yellow);
      font-size: 1.3rem;
      cursor: pointer;
      font-family: var(--tit);
    }
    .modal-alunos-table table, 
    .modal-financeiro .table-container table /* Adicionado seletor para tabela financeira se usar container */ {
      width: 100%;
      background: #133829;
      border-radius: 1rem;
      box-shadow: 0 1px 8px #19fff744;
      font-size: 1.05rem;
      margin-bottom: 1rem;
      border-collapse: separate; /* Para border-radius funcionar com sticky headers */
      border-spacing: 0;
    }
     .modal-alunos-table th, .modal-alunos-table td,
     .modal-financeiro .table-container th, .modal-financeiro .table-container td {
      padding: 0.7rem 0.4rem;
      border-bottom: 1px solid #263b2b;
      text-align: center !important;
      vertical-align: middle !important;
    }
     .modal-alunos-table th,
     .modal-financeiro .table-container th {
      color: var(--c-green);
      font-family: var(--tit);
      border-bottom: 2px solid var(--c-cyan);
      position: sticky; 
      top: -1px; /* Pequeno ajuste para garantir que a borda inferior não sobreponha */
      background: #122921; 
      z-index: 1; /* Para garantir que o header da tabela fique sobre o conteúdo ao rolar */
    }
    .modal-alunos-table tr:last-child td,
    .modal-financeiro .table-container tr:last-child td { border-bottom: none; }

    .modal-diario-filtro {
      display: flex;
      flex-wrap: wrap;
      gap: 0.7rem;
      justify-content: flex-start;
      margin-bottom: 1.2rem;
      align-items: flex-end;
    }
    .modal-diario-filtro label {
      font-size: 1.02rem;
      color: #9cf7ee;
      font-family: var(--bod);
      margin-bottom: 0.1rem;
      margin-right: 0.4rem;
    }
    .modal-diario-filtro input[type="text"],
    .modal-diario-filtro input[type="date"] {
      background: #193c2c;
      border: 1.2px solid var(--c-green);
      color: #d3fff3;
      padding: 0.5rem 0.7rem;
      border-radius: 0.7rem;
      font-size: 0.98rem;
      font-family: var(--bod);
      outline: none;
      margin-right: 1rem;
    }
    .modal-diario-filtro input[type="text"]:focus,
    .modal-diario-filtro input[type="date"]:focus {
      border-color: var(--c-cyan);
    }
    .bloco-notas-lista {
      background: #17352e;
      border-radius: 1rem;
      box-shadow: 0 1px 8px #19fff733;
      padding: 1.2rem 1rem;
      margin-top: 1.2rem;
      font-size: 1.04rem;
      min-height: 34px;
      max-height: 170px;
      overflow-y: auto;
      overscroll-behavior-y: contain; 
    }
    .bloco-notas-lista ul {
      list-style: disc inside;
      margin: 0;
      padding-left: 1.1em;
    }
    .bloco-notas-lista li {
      margin-bottom: 0.35em;
      word-break: break-all;
      color: #afffbb;
    }
    .modal-diario-table { /* Container para a tabela do diário */
      width: 100%;
      max-height: 50vh; 
      overflow-y: auto; 
      overscroll-behavior-y: contain; 
      margin-bottom: 0.5rem;
      border-radius: 1rem; /* Aplicar o radius aqui */
      background: #163221; 
      box-shadow: 0 1px 8px #19fff744;
    }
    .modal-diario-table table { 
        width: 100%; 
        font-size: 1.01rem;
        border-collapse: separate; /* Para sticky header e radius na div pai */
        border-spacing: 0;
    }
    .modal-diario-table th, .modal-diario-table td {
      padding: 0.6rem 0.5rem;
      border-bottom: 1px solid #263b2b;
    }
    .modal-diario-table th {
      color: var(--c-green);
      font-family: var(--tit);
      border-bottom: 2px solid var(--c-cyan);
      text-align: left;
      position: sticky; 
      top: -1px;
      background: #163221; 
      z-index: 1;
    }
    .modal-diario-table tr:first-child th:first-child { border-top-left-radius: 1rem; } /* Cantos arredondados para o header fixo */
    .modal-diario-table tr:first-child th:last-child { border-top-right-radius: 1rem; }
    .modal-diario-table tr:last-child td { border-bottom: none; }
    .modal-diario-table tr:last-child td:first-child { border-bottom-left-radius: 1rem; }
    .modal-diario-table tr:last-child td:last-child { border-bottom-right-radius: 1rem; }
    .modal-diario-table td { color: #def2e1; word-break: break-word; }
    
    /* Container para a tabela financeira para melhor controle de scroll e sticky header */
    #conteudoModalFinanceiro.table-container {
        overflow-y: auto;
        max-height: 70vh; /* Ou a altura que desejar */
        overscroll-behavior-y: contain;
        border-radius: 1rem;
        background: #133829; /* Fundo para o container da tabela */
    }
  </style>
</head>
<body>
  <nav class="atalhos-lateral" aria-label="Atalhos Rápidos">
    <a href="https://classroom.google.com/" target="_blank" class="ataho-link" title="Google Classroom" tabindex="1" aria-label="Google Classroom"><i class="fab fa-google"></i></a>
    <a href="https://meet.google.com/" target="_blank" class="ataho-link" title="Google Meet" tabindex="2" aria-label="Google Meet"><i class="fas fa-video"></i></a>
    <a href="https://drive.google.com/" target="_blank" class="ataho-link" title="Google Drive" tabindex="3" aria-label="Google Drive"><i class="fab fa-google-drive"></i></a>
    <a href="https://docs.google.com/" target="_blank" class="ataho-link" title="Google Docs" tabindex="4" aria-label="Google Docs"><i class="far fa-file-alt"></i></a>
    <a href="https://sheets.google.com/" target="_blank" class="ataho-link" title="Google Planilhas" tabindex="5" aria-label="Google Planilhas"><i class="fas fa-table"></i></a>
    <a href="https://calendar.google.com/" target="_blank" class="ataho-link" title="Google Agenda" tabindex="6" aria-label="Google Agenda"><i class="far fa-calendar-alt"></i></a>
    <a href="https://slides.google.com/" target="_blank" class="ataho-link" title="Google Apresentações" tabindex="7" aria-label="Google Apresentações"><i class="fas fa-chalkboard"></i></a>
    <a href="https://fast.com/" target="_blank" class="ataho-link" title="Teste de Velocidade (Fast)" tabindex="8" aria-label="Teste de Velocidade"><i class="fas fa-laptop"></i></a>
    <a href="https://convertio.co/pt/" target="_blank" class="ataho-link" title="Convertio" tabindex="9" aria-label="Convertio"><i class="fas fa-globe"></i></a>
    <a href="https://ravellsl.github.io/ferramenta-dev-links/" target="_blank" class="ataho-link" title="Dev Links" tabindex="10" aria-label="Dev Links"><i class="fas fa-code"></i></a>
    <a href="https://ravellsl.github.io/agentes-de-IA/" target="_blank" class="ataho-link" title="Agentes de IA" tabindex="11" aria-label="Agentes de IA"><i class="fas fa-robot"></i></a>
    <a href="https://www.videosmaller.com/pt/" target="_blank" class="ataho-link" title="Compressor de Vídeo" tabindex="12" aria-label="Compressor de Vídeo"><i class="fas fa-exchange-alt"></i></a>
    <a href="https://ravellsl.github.io/ferramenta-busca-noticias/" target="_blank" class="ataho-link" title="Notícias" tabindex="13" aria-label="Notícias"><i class="fas fa-newspaper"></i></a>
  </nav>
  <header>
    RS TECH
  </header>
  <main class="dashboard-grid">
    <div class="card diario-classe">
      <h2>Diário de Classe</h2>
      <form id="formDiarioClasse" onsubmit="event.preventDefault(); salvarDiarioClasse();">
        <input id="diarioAluno" type="text" placeholder="Nome do Aluno" autocomplete="off" required>
        <input id="diarioData" type="date" required>
        <textarea id="diarioConteudo" rows="4" placeholder="Conteúdo ministrado..." required></textarea>
        <button class="btn" type="submit">Salvar</button>
      </form>
      <button class="btn" style="margin-top:0.4rem" onclick="abrirModalDiario()">Visualizar Diário</button>
    </div>
    <div class="card cadastro-alunos">
      <h2>Cadastro de Alunos (AnyDesk)</h2>
      <form onsubmit="event.preventDefault(); adicionarAluno();">
        <input id="nomeAluno" placeholder="Nome do Aluno" autocomplete="off" oninput="mostrarBotoesAluno()">
        <input id="anydeskAluno" placeholder="AnyDesk do Aluno" autocomplete="off" oninput="mostrarBotoesAluno()">
        <div class="alunos-btns">
          <button class="btn" type="submit" id="btnAlunoAdd">Cadastrar</button>
          <button class="btn" type="button" id="btnAlunoLimpar" onclick="limparAlunoCampos()">Limpar Tudo</button>
        </div>
        <button class="btn" type="button" id="btnAlunoEdit" style="display:none;" onclick="confirmarEdicaoAluno()">Salvar Edição</button>
        <button class="btn" type="button" id="btnAlunoCancel" style="display:none;" onclick="cancelarEdicaoAluno()">Cancelar</button>
      </form>
      <button class="btn" style="margin-top:0.6rem" onclick="abrirModalAlunos()">Visualizar Alunos</button>
    </div>
    <div class="card controle-financeiro">
      <h2>Controle Financeiro</h2>
      <form onsubmit="event.preventDefault(); adicionarFinanceiro();">
        <input id="nomeFinanceiro" placeholder="Nome do Aluno" autocomplete="off" oninput="mostrarBotoesFinanceiro()">
        <input id="valorFinanceiro" type="number" placeholder="Valor (R$)" autocomplete="off" oninput="mostrarBotoesFinanceiro()">
        <select id="statusFinanceiro" onchange="mostrarBotoesFinanceiro()">
          <option value="Pago">Pago</option>
          <option value="Pendente">Pendente</option>
        </select>
        <select id="tipoFinanceiro" onchange="mostrarBotoesFinanceiro()" style="margin-bottom:0.6rem;">
          <option value="Mensalidade">Mensalidade</option>
          <option value="Serviço Extra">Serviço Extra</option>
        </select>
        <button class="btn" type="submit" id="btnFinAdd" style="display:none;">Lançar</button>
        <button class="btn" type="button" id="btnFinEdit" style="display:none;" onclick="confirmarEdicaoFinanceiro()">Salvar Edição</button>
        <button class="btn" type="button" id="btnFinCancel" style="display:none;" onclick="cancelarEdicaoFinanceiro()">Cancelar</button>
        <button class="btn" type="button" id="btnFinLimpar" style="display:none;" onclick="limparFinanceiroCampos()">Limpar Tudo</button>
      </form>
      <button class="btn" style="margin-bottom:0.9rem" onclick="abrirModalFinanceiro()">Visualizar Controle Financeiro</button>
    </div>
    <div class="card bloco-notas">
      <h2>Bloco de Notas</h2>
      <textarea id="blocoNotas" rows="5" placeholder="Digite suas anotações livres..."></textarea>
      <button class="btn" onclick="salvarBlocoNotas()">Salvar</button>
      <div class="bloco-notas-lista" id="blocoNotasLista"></div>
    </div>
    <div class="card anotacoes-rapidas">
      <h2>Anotações Rápidas</h2>
      <form onsubmit="event.preventDefault(); adicionarAnotacao();">
        <input id="anotacaoInput" placeholder="Digite uma anotação rápida" autocomplete="off" oninput="mostrarBotoesAnotacao()">
        <button class="btn" type="submit" id="btnAddAnotacao" style="display:none;">Adicionar</button>
        <button class="btn" type="button" id="btnLimparAnotacao" style="display:none;" onclick="limparAnotacaoCampos()">Limpar Tudo</button>
      </form>
      <table id="tabelaAnotacoes">
        <thead>
          <tr><th>Anotação</th><th style="width:70px;">Ações</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
    <div class="card tarefas-pendentes">
      <h2>Tarefas Pendentes</h2>
      <form onsubmit="event.preventDefault(); adicionarTarefa();">
        <input id="tarefaInput" placeholder="Adicionar nova tarefa" autocomplete="off" oninput="mostrarBotoesTarefa()">
        <button class="btn" type="submit" id="btnTarefaAdd" style="display:none;">Adicionar</button>
        <button class="btn" type="button" id="btnTarefaEdit" style="display:none;" onclick="confirmarEdicaoTarefa()">Salvar Edição</button>
        <button class="btn" type="button" id="btnTarefaCancel" style="display:none;" onclick="cancelarEdicaoTarefa()">Cancelar</button>
        <button class="btn" type="button" id="btnTarefaLimpar" style="display:none;" onclick="limparTarefaCampos()">Limpar Tudo</button>
      </form>
      <table id="tabelaTarefas">
        <thead>
          <tr><th>Tarefa</th><th>Status</th><th style="width:90px;">Ações</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </main>
  <a class="portal-acesso" href="https://ravellsl.github.io/rstech/" target="_blank">
    <i class="fas fa-external-link-alt"></i> ACESSO AO PORTAL PRINCIPAL
  </a>
  <div class="main-controls">
    <button class="btn-export" onclick="exportarDados()"><i class="fas fa-download"></i> Exportar Dados</button>
    <label class="btn-import" style="display:inline-block;cursor:pointer;">
      <i class="fas fa-upload"></i> Importar Dados
      <input type="file" id="importFile" accept=".json" style="display:none" onchange="importarDados(event)">
    </label>
  </div>
  <div class="modal-bg" id="modalDiario">
    <div class="modal-diario">
      <button class="fechar-modal" onclick="fecharModalDiario()" title="Fechar">&times;</button>
      <h3>Diário de Classe - Registros</h3>
      <div class="modal-diario-filtro">
        <label for="filtroNome">Aluno:</label>
        <input type="text" id="filtroNome" placeholder="Filtrar por nome">
        <label for="filtroData">Data:</label>
        <input type="date" id="filtroData">
      </div>
      <div class="modal-diario-table" id="conteudoModalDiario"></div>
    </div>
  </div>
  <div class="modal-bg" id="modalFinanceiro">
    <div class="modal-financeiro">
      <button class="fechar-modal" onclick="fecharModalFinanceiro()" title="Fechar">&times;</button>
      <h3>Controle Financeiro - Lançamentos</h3>
      <div id="conteudoModalFinanceiro" class="table-container">
          </div>
    </div>
  </div>
  <div class="modal-bg" id="modalAlunos">
    <div class="modal-alunos">
      <button class="fechar-modal" onclick="fecharModalAlunos()" title="Fechar">&times;</button>
      <h3>Alunos Cadastrados</h3>
      <div class="modal-alunos-table" id="conteudoModalAlunos"> </div>
    </div>
  </div>
  <footer>
    2025
  </footer>
  <script>
    // Utilitários de armazenamento
    function salvarLocal(key, value) { localStorage.setItem(key, value); }
    function recuperarLocal(key, fallback) { return localStorage.getItem(key) || fallback; }

    // ---------------- BLOCO DE NOTAS ----------------
    function salvarBlocoNotas() {
      let texto = document.getElementById('blocoNotas').value.trim();
      if (!texto) return;
      let lista = JSON.parse(recuperarLocal('blocoNotasLista', '[]'));
      lista.push(texto);
      salvarLocal('blocoNotasLista', JSON.stringify(lista));
      document.getElementById('blocoNotas').value = '';
      listarBlocoNotas();
    }
    function listarBlocoNotas() {
      let lista = JSON.parse(recuperarLocal('blocoNotasLista', '[]'));
      let html = "<ul>";
      lista.slice().reverse().forEach((item, idx) => { // .slice() para não modificar original com reverse
        html += `<li>${item}</li>`;
      });
      html += "</ul>";
      document.getElementById('blocoNotasLista').innerHTML = lista.length ? html : "<span style='color:#9fc;'>Nenhuma anotação salva ainda.</span>";
    }
    

    // ---------------- DIÁRIO DE CLASSE ATUALIZADO ----------------
    function salvarDiarioClasse() {
      const aluno = document.getElementById('diarioAluno').value.trim();
      const data = document.getElementById('diarioData').value;
      const conteudo = document.getElementById('diarioConteudo').value.trim();
      if (!aluno || !data || !conteudo) { alert('Preencha todos os campos.'); return; }
      let lista = JSON.parse(recuperarLocal('diarioClasseLista', '[]'));
      lista.push({ aluno, data, conteudo });
      salvarLocal('diarioClasseLista', JSON.stringify(lista));
      document.getElementById('formDiarioClasse').reset();
      alert('Registro salvo no Diário de Classe.');
    }
    function abrirModalDiario() {
      document.getElementById('modalDiario').classList.add('active');
      document.getElementById('filtroNome').value = '';
      document.getElementById('filtroData').value = '';
      filtrarModalDiario();
    }
    function fecharModalDiario() {
      document.getElementById('modalDiario').classList.remove('active');
    }
    document.addEventListener('input', function(e){
      if( (e.target.id==='filtroNome' || e.target.id==='filtroData') && document.getElementById('modalDiario').classList.contains('active') ) {
        filtrarModalDiario();
      }
    });
    function filtrarModalDiario() {
      let lista = JSON.parse(recuperarLocal('diarioClasseLista','[]'));
      const filtroNome = document.getElementById('filtroNome').value.trim().toLowerCase();
      const filtroData = document.getElementById('filtroData').value;
      let filtrados = lista.filter(reg =>
        (!filtroNome || reg.aluno.toLowerCase().includes(filtroNome)) &&
        (!filtroData || reg.data === filtroData)
      );
      let html = `<table><thead>
          <tr>
            <th>Data</th>
            <th>Aluno</th>
            <th>Conteúdo Ministrado</th>
          </tr>
        </thead><tbody>`;
      if(filtrados.length){
        filtrados.slice().reverse().forEach(reg=>{ // .slice() para criar cópia antes de reverter
          html += `<tr>
            <td>${reg.data ? reg.data.split('-').reverse().join('/') : ''}</td>
            <td>${reg.aluno}</td>
            <td>${reg.conteudo}</td>
          </tr>`;
        });
      } else {
        html += `<tr><td colspan="3" style="text-align:center;color:#bff;">Nenhum registro encontrado.</td></tr>`;
      }
      html += `</tbody></table>`;
      document.getElementById('conteudoModalDiario').innerHTML = html;
    }
    
    // ---------------- CONTROLE FINANCEIRO ----------------
    let finEditIdx = null;
    function mostrarBotoesFinanceiro() {
      const nome = document.getElementById('nomeFinanceiro').value.trim();
      const valor = document.getElementById('valorFinanceiro').value.trim();
      const showAdd = nome && valor && finEditIdx === null; 
      const showEdit = nome && valor && finEditIdx !== null; 
      const showAnyButton = nome || valor; 
      
      document.getElementById('btnFinAdd').style.display = showAdd ? '' : 'none';
      document.getElementById('btnFinEdit').style.display = showEdit ? '' : 'none';
      document.getElementById('btnFinCancel').style.display = finEditIdx !== null ? '' : 'none'; 
      document.getElementById('btnFinLimpar').style.display = showAnyButton && finEditIdx === null ? '' : 'none'; 
    }
    function adicionarFinanceiro() {
      const nome = document.getElementById('nomeFinanceiro').value.trim();
      const valor = document.getElementById('valorFinanceiro').value.trim();
      const status = document.getElementById('statusFinanceiro').value;
      const tipo = document.getElementById('tipoFinanceiro').value;
      if (!nome || !valor) { alert('Preencha nome e valor.'); return; }
      let lista = JSON.parse(recuperarLocal('controleFinanceiro','[]'));
      if (finEditIdx === null) {
        lista.push({nome, valor, status, tipo});
      } else {
        lista[finEditIdx] = {nome, valor, status, tipo};
      }
      salvarLocal('controleFinanceiro', JSON.stringify(lista));
      limparFinanceiroCampos(); 
      if (document.getElementById('modalFinanceiro').classList.contains('active')) {
         abrirModalFinanceiro(); 
      }
    }
    function editarFinanceiro(idx) {
        let lista = JSON.parse(recuperarLocal('controleFinanceiro','[]'));
        document.getElementById('nomeFinanceiro').value = lista[idx].nome;
        document.getElementById('valorFinanceiro').value = lista[idx].valor;
        document.getElementById('statusFinanceiro').value = lista[idx].status;
        document.getElementById('tipoFinanceiro').value = lista[idx].tipo;
        finEditIdx = idx;
        mostrarBotoesFinanceiro();
        fecharModalFinanceiro(); 
    }
    function removerFinanceiro(idx) {
      let lista = JSON.parse(recuperarLocal('controleFinanceiro','[]'));
      lista.splice(idx,1);
      salvarLocal('controleFinanceiro', JSON.stringify(lista));
      if (document.getElementById('modalFinanceiro').classList.contains('active')) {
         abrirModalFinanceiro(); 
      }
    }
    function confirmarEdicaoFinanceiro() {
        adicionarFinanceiro(); 
    }
    function limparFinanceiroCampos() {
      document.getElementById('nomeFinanceiro').value = '';
      document.getElementById('valorFinanceiro').value = '';
      document.getElementById('statusFinanceiro').value = 'Pago';
      document.getElementById('tipoFinanceiro').value = 'Mensalidade';
      finEditIdx = null; 
      mostrarBotoesFinanceiro();
    }
    function cancelarEdicaoFinanceiro() {
      limparFinanceiroCampos(); 
    }
    
    function abrirModalFinanceiro() {
      let lista = JSON.parse(recuperarLocal('controleFinanceiro','[]'));
      let html = `<table>
        <thead>
          <tr>
            <th>Nome</th>
            <th>Valor</th>
            <th>Status</th>
            <th>Tipo</th>
            <th>Ações</th>
          </tr>
        </thead>
        <tbody>
      `;
      if(lista.length){
        lista.slice().reverse().forEach((f, originalIndex)=>{ 
          const idx = lista.length - 1 - originalIndex; 
          html += `<tr>
            <td>${f.nome}</td>
            <td>R$ ${parseFloat(f.valor).toFixed(2)}</td>
            <td style="color:${f.status === 'Pago' ? 'var(--c-green)' : 'var(--c-yellow)'};">${f.status}</td>
            <td>${f.tipo || ''}</td>
            <td class="table-actions">
              <button onclick="editarFinanceiro(${idx})" title="Editar"><i class="fas fa-edit"></i></button>
              <button onclick="removerFinanceiro(${idx})" title="Remover"><i class="fas fa-trash"></i></button>
            </td>
          </tr>`;
        });
      } else {
        html += `<tr><td colspan="5" style="text-align:center;color:#bff;">Nenhum lançamento registrado.</td></tr>`;
      }
      html += `</tbody></table>`;
      // Adiciona a classe table-container dinamicamente se ainda não tiver
      const container = document.getElementById('conteudoModalFinanceiro');
      if (!container.classList.contains('table-container')) {
          container.classList.add('table-container');
      }
      container.innerHTML = html;
      document.getElementById('modalFinanceiro').classList.add('active');
    }
    function fecharModalFinanceiro() {
      document.getElementById('modalFinanceiro').classList.remove('active');
    }
    
    // -- Cadastro de Alunos (com edição e modal)
    let alunoEditIdx = null;
    function mostrarBotoesAluno() {
        const nome = document.getElementById('nomeAluno').value.trim();
        const anydesk = document.getElementById('anydeskAluno').value.trim();
        const showAdd = nome && anydesk && alunoEditIdx === null;
        const showEdit = nome && anydesk && alunoEditIdx !== null;
        const showAnyButton = nome || anydesk;

        document.getElementById('btnAlunoAdd').style.display = showAdd ? '' : 'none';
        document.getElementById('btnAlunoEdit').style.display = showEdit ? '' : 'none';
        document.getElementById('btnAlunoCancel').style.display = alunoEditIdx !== null ? '' : 'none';
        document.getElementById('btnAlunoLimpar').style.display = showAnyButton && alunoEditIdx === null ? '' : 'none';
    }
    function adicionarAluno() {
      const nome = document.getElementById('nomeAluno').value.trim();
      const anydesk = document.getElementById('anydeskAluno').value.trim();
      if (!nome || !anydesk) { alert('Preencha ambos os campos.'); return; }
      let lista = JSON.parse(recuperarLocal('alunosAnyDesk','[]'));
      if (alunoEditIdx === null) {
        lista.push({nome, anydesk});
      } else {
        lista[alunoEditIdx] = {nome, anydesk};
      }
      salvarLocal('alunosAnyDesk', JSON.stringify(lista));
      limparAlunoCampos();
      if (document.getElementById('modalAlunos').classList.contains('active')) {
         abrirModalAlunos();
      }
    }
    function editarAluno(idx) {
      let lista = JSON.parse(recuperarLocal('alunosAnyDesk','[]'));
      document.getElementById('nomeAluno').value = lista[idx].nome;
      document.getElementById('anydeskAluno').value = lista[idx].anydesk;
      alunoEditIdx = idx;
      mostrarBotoesAluno();
      fecharModalAlunos(); 
    }
    function confirmarEdicaoAluno() { adicionarAluno(); }
    function cancelarEdicaoAluno() {
      limparAlunoCampos();
    }
    function removerAluno(idx) {
      let lista = JSON.parse(recuperarLocal('alunosAnyDesk','[]'));
      lista.splice(idx,1);
      salvarLocal('alunosAnyDesk', JSON.stringify(lista));
      if (document.getElementById('modalAlunos').classList.contains('active')) {
         abrirModalAlunos();
      }
    }
    function limparAlunoCampos() {
      document.getElementById('nomeAluno').value = '';
      document.getElementById('anydeskAluno').value = '';
      alunoEditIdx = null;
      mostrarBotoesAluno();
    }
    
    function abrirModalAlunos() {
      let lista = JSON.parse(recuperarLocal('alunosAnyDesk','[]'));
      let html = `<table>
        <thead>
          <tr>
            <th>Nome</th>
            <th>AnyDesk</th>
            <th>Ações</th>
          </tr>
        </thead>
        <tbody>
      `;
      if(lista.length){
        lista.slice().reverse().forEach((a, originalIndex)=>{
          const idx = lista.length - 1 - originalIndex;
          html += `<tr>
            <td style="text-align:center;">${a.nome}</td>
            <td style="text-align:center;">${a.anydesk}</td>
            <td class="table-actions">
              <button onclick="editarAluno(${idx})" title="Editar"><i class="fas fa-edit"></i></button>
              <button onclick="removerAluno(${idx})" title="Remover"><i class="fas fa-trash"></i></button>
            </td>
          </tr>`;
        });
      } else {
        html += `<tr><td colspan="3" style="text-align:center;color:#bff;">Nenhum aluno cadastrado.</td></tr>`;
      }
      html += `</tbody></table>`;
      document.getElementById('conteudoModalAlunos').innerHTML = html; // A div já tem a classe modal-alunos-table
      document.getElementById('modalAlunos').classList.add('active');
    }
    function fecharModalAlunos() {
      document.getElementById('modalAlunos').classList.remove('active');
    }

    // -- Anotações Rápidas
    function mostrarBotoesAnotacao() {
      const val = document.getElementById('anotacaoInput').value.trim();
      document.getElementById('btnAddAnotacao').style.display = val ? '' : 'none';
      document.getElementById('btnLimparAnotacao').style.display = val ? '' : 'none';
    }
    function adicionarAnotacao() {
      const val = document.getElementById('anotacaoInput').value.trim();
      if (!val) return;
      let anotacoes = JSON.parse(recuperarLocal('anotacoesRapidas','[]'));
      anotacoes.push(val);
      salvarLocal('anotacoesRapidas', JSON.stringify(anotacoes));
      listarAnotacoes();
      document.getElementById('anotacaoInput').value = '';
      mostrarBotoesAnotacao();
    }
    function removerAnotacao(idx) {
      let anotacoes = JSON.parse(recuperarLocal('anotacoesRapidas','[]'));
      anotacoes.splice(idx,1);
      salvarLocal('anotacoesRapidas', JSON.stringify(anotacoes));
      listarAnotacoes();
    }
    function limparAnotacaoCampos() {
      document.getElementById('anotacaoInput').value = '';
      mostrarBotoesAnotacao();
    }
    function listarAnotacoes() {
      let anotacoes = JSON.parse(recuperarLocal('anotacoesRapidas','[]'));
      let tbody = document.getElementById('tabelaAnotacoes').getElementsByTagName('tbody')[0];
      tbody.innerHTML = '';
      anotacoes.slice().reverse().forEach((a, originalIndex) => { 
        const idx = anotacoes.length - 1 - originalIndex;
        tbody.innerHTML += `
          <tr>
            <td>${a}</td>
            <td class="table-actions">
              <button onclick="removerAnotacao(${idx})" title="Remover"><i class="fas fa-trash"></i></button>
            </td>
          </tr>`;
      });
    }
    
    // -- Tarefas Pendentes
    let tarefaEditIdx = null;
    function mostrarBotoesTarefa() {
      const val = document.getElementById('tarefaInput').value.trim();
      const showAdd = val && tarefaEditIdx === null;
      const showEdit = val && tarefaEditIdx !== null;
      const showAnyButton = val;

      document.getElementById('btnTarefaAdd').style.display = showAdd ? '' : 'none';
      document.getElementById('btnTarefaEdit').style.display = showEdit ? '' : 'none';
      document.getElementById('btnTarefaCancel').style.display = tarefaEditIdx !== null ? '' : 'none';
      document.getElementById('btnTarefaLimpar').style.display = showAnyButton && tarefaEditIdx === null ? '' : 'none';
    }
    function adicionarTarefa() {
      const val = document.getElementById('tarefaInput').value.trim();
      if (!val) return;
      let tarefas = JSON.parse(recuperarLocal('tarefasPendentes','[]'));
      if (tarefaEditIdx === null) {
        tarefas.push({tarefa: val, done: false});
      } else {
        tarefas[tarefaEditIdx].tarefa = val; 
      }
      salvarLocal('tarefasPendentes', JSON.stringify(tarefas));
      limparTarefaCampos(); 
    }
    function editarTarefa(idx) {
        let tarefas = JSON.parse(recuperarLocal('tarefasPendentes','[]'));
        document.getElementById('tarefaInput').value = tarefas[idx].tarefa;
        tarefaEditIdx = idx;
        mostrarBotoesTarefa();
    }
    function confirmarEdicaoTarefa() {
        adicionarTarefa();
    }
    function removerTarefa(idx) {
      let tarefas = JSON.parse(recuperarLocal('tarefasPendentes','[]'));
      tarefas.splice(idx, 1);
      salvarLocal('tarefasPendentes', JSON.stringify(tarefas));
      listarTarefas();
    }
    function concluirTarefa(idx) {
      let tarefas = JSON.parse(recuperarLocal('tarefasPendentes','[]'));
      tarefas[idx].done = !tarefas[idx].done;
      salvarLocal('tarefasPendentes', JSON.stringify(tarefas));
      listarTarefas();
    }
    function limparTarefaCampos() {
      document.getElementById('tarefaInput').value = '';
      tarefaEditIdx = null;
      mostrarBotoesTarefa();
      listarTarefas(); 
    }
    function cancelarEdicaoTarefa() {
      limparTarefaCampos();
    }
    function listarTarefas() {
      let tarefas = JSON.parse(recuperarLocal('tarefasPendentes','[]'));
      let tbody = document.getElementById('tabelaTarefas').getElementsByTagName('tbody')[0];
      tbody.innerHTML = '';
      tarefas.slice().reverse().forEach((t, originalIndex) => { 
        const idx = tarefas.length - 1 - originalIndex;
        tbody.innerHTML += `
          <tr${t.done ? ' style="text-decoration:line-through;opacity:.6;"' : ''}>
            <td>${t.tarefa}</td>
            <td>
              <button onclick="concluirTarefa(${idx})" title="${t.done ? 'Desfazer' : 'Concluir'}" style="color:var(--c-green);background:none;border:none;font-size:1.1rem; cursor:pointer;">
                <i class="fas fa-${t.done ? 'undo' : 'check'}"></i>
              </button>
            </td>
            <td class="table-actions">
              <button onclick="editarTarefa(${idx})" title="Editar"><i class="fas fa-edit"></i></button>
              <button onclick="removerTarefa(${idx})" title="Remover"><i class="fas fa-trash"></i></button>
            </td>
          </tr>`;
      });
    }
    
    // Event listener para fechar modais com ESC
    document.addEventListener('keydown', function(e){
      if(e.key === "Escape") {
        if (document.getElementById('modalDiario').classList.contains('active')) fecharModalDiario();
        if (document.getElementById('modalFinanceiro').classList.contains('active')) fecharModalFinanceiro();
        if (document.getElementById('modalAlunos').classList.contains('active')) fecharModalAlunos();
      }
    });

    // EXPORTAÇÃO / IMPORTAÇÃO
    function exportarDados() {
      const dados = {
        blocoNotasLista: recuperarLocal('blocoNotasLista','[]'),
        diarioClasseLista: recuperarLocal('diarioClasseLista','[]'),
        alunosAnyDesk: recuperarLocal('alunosAnyDesk','[]'),
        tarefasPendentes: recuperarLocal('tarefasPendentes','[]'),
        anotacoesRapidas: recuperarLocal('anotacoesRapidas','[]'),
        controleFinanceiro: recuperarLocal('controleFinanceiro','[]')
      };
      const blob = new Blob([JSON.stringify(dados, null, 2)], {type: "application/json"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      const timestamp = new Date().toISOString().slice(0, 19).replace(/[-:T]/g, "");
      a.download = `dashboard_rs_tech_backup_${timestamp}.json`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }
    function importarDados(event) {
      const file = event.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const dados = JSON.parse(e.target.result);
          if (typeof dados !== "object") throw new Error("Formato inválido!");
          if ("blocoNotasLista" in dados) salvarLocal('blocoNotasLista', dados.blocoNotasLista);
          if ("diarioClasseLista" in dados) salvarLocal('diarioClasseLista', dados.diarioClasseLista);
          if ("alunosAnyDesk" in dados) salvarLocal('alunosAnyDesk', dados.alunosAnyDesk);
          if ("tarefasPendentes" in dados) salvarLocal('tarefasPendentes', dados.tarefasPendentes);
          if ("anotacoesRapidas" in dados) salvarLocal('anotacoesRapidas', dados.anotacoesRapidas);
          if ("controleFinanceiro" in dados) salvarLocal('controleFinanceiro', dados.controleFinanceiro);
          
          document.getElementById('formDiarioClasse').reset();
          limparAlunoCampos(); 
          limparFinanceiroCampos(); 
          limparAnotacaoCampos(); 
          limparTarefaCampos(); 
          listarBlocoNotas();
          alert("Dados importados com sucesso! As listas e formulários foram atualizados.");
        } catch(e) {
          alert("Falha na importação: " + e.message);
        }
      };
      reader.readAsText(file);
      event.target.value = ""; 
    }

    // Inicializar todas as listagens e estados de botões ao carregar a página
    document.addEventListener('DOMContentLoaded', () => {
        listarBlocoNotas();
        mostrarBotoesAluno();
        mostrarBotoesFinanceiro();
        mostrarBotoesAnotacao();
        listarAnotacoes(); 
        mostrarBotoesTarefa();
        listarTarefas(); 
    });

  </script>
</body>
</html>
