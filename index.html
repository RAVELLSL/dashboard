<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard Corporativa - RS TECH</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css">
  <style>
    :root {
  --c1: #18f2b2;   /* Verde-água neon */
  --c2: #13b0fa;   /* Azul neon */
  --c3: #2ae5ec;   /* Verde-azul intermediário */
  --c4: #1e63b6;   /* Azul escuro */
  --bg-card: #202737;
  --bg-main: linear-gradient(135deg, #103445 0%, #1c3150 100%);
  --txt: #e0eaff;
  --txt-dark: #112130;
  --accent: #25314a;
  --danger: #f24b86;
  --highlight: linear-gradient(90deg, #18f2b2 0%, #13b0fa 100%);
  --tit: 'Orbitron', Arial, sans-serif;
  --bod: 'Share Tech Mono', monospace;
}

/* Garante box-sizing correto em toda a aplicação */
html, body, *, *::before, *::after {
  box-sizing: border-box;
}

/* Corpo e fundo */
body {
  background: var(--bg-main) fixed;
  font-family: var(--bod);
  color: var(--txt);
  margin: 0; padding: 0;
  min-height: 100vh;
  padding-left: 65px;
  transition: padding-left 0.18s;
}

header {
  background: var(--highlight);
  color: #103445;
  text-align: center;
  padding: 2rem 1rem 1rem 1rem;
  font-family: var(--tit);
  font-size: 2.2rem;
  letter-spacing: 2px;
  font-weight: bold;
  box-shadow: 0 2px 12px #10203044;
}

/* Barra lateral fixa e vertical */
.atalhos-lateral {
  position: fixed;
  top: 0;
  left: 0;
  width: 65px;
  height: 100vh;
  background: #1a2030;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.7rem;
  z-index: 99;
  box-shadow: 2px 0 12px #18f2b226;
  padding-top: 1.2rem;
}
.atalhos-lateral .ataho-link {
  width: 46px;
  height: 46px;
  margin: 0.16rem 0;
  background: #242940;
  color: #13b0fa;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 16px;
  font-size: 1.4rem;
  transition: background 0.18s, color 0.13s, box-shadow 0.16s;
  box-shadow: 0 1px 8px #13b0fa19;
  border: none;
  outline: none;
  text-decoration: none;
}
.atalhos-lateral .ataho-link:hover, .atalhos-lateral .ataho-link:focus {
  background: var(--c1);
  color: #183448;
  box-shadow: 0 2px 18px #18f2b244;
}
.atalhos-lateral .ataho-link.active, .atalhos-lateral .ataho-link[aria-current="page"] {
  background: #f24b86;
  color: #fff;
}

@media (max-width: 600px) {
  body { padding-left: 52px; }
  .atalhos-lateral {
    width: 52px;
    padding-top: 0.6rem;
  }
  .atalhos-lateral .ataho-link {
    width: 38px;
    height: 38px;
    font-size: 1.09rem;
    margin: 0.08rem 0;
  }
}

/* Top controls (Exportar/Importar) */
.top-controls {
  display: flex;
  justify-content: flex-end;
  gap: 1.2rem;
  margin: 1.2rem 2vw 0 2vw;
}
.btn-export, .btn-import {
  background: var(--c2);
  color: #251f33;
  font-family: var(--tit);
  border: none;
  border-radius: 1.2rem;
  padding: 0.6rem 1.5rem;
  font-size: 1.05rem;
  font-weight: bold;
  letter-spacing: 0.5px;
  cursor: pointer;
  box-shadow: 0 2px 8px #0003;
  transition: background .18s;
}
.btn-export:hover, .btn-import:hover {
  background: var(--c1);
  color: #fff;
}

/* Grid de cards */
.dashboard-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 2rem;
  padding: 2rem 2vw 1rem 2vw;
  max-width: 1440px;
  margin: auto;
}
@media (max-width: 1100px) {
  .dashboard-grid { grid-template-columns: 1fr 1fr; gap: 1.1rem; }
}
@media (max-width: 800px) {
  .dashboard-grid { grid-template-columns: 1fr; gap: 1.1rem; }
  .dashboard-grid .card { min-width: 92vw; }
}
@media (max-width: 600px) {
  header { font-size: 1.1rem; padding: 1rem 0.4rem; }
  .dashboard-grid { gap: 0.5rem; padding: 0.5rem 0.1rem; }
  .dashboard-grid .card { padding: 0.5rem 0.1rem 0.8rem 0.1rem; min-width: 98vw; max-width: 100vw; }
}

.card {
  background: var(--bg-card);
  border-radius: 1.7rem;
  box-shadow: 0 2px 24px #09162b66;
  padding: 1.5rem 1.2rem 1.2rem 1.2rem;
  display: flex;
  flex-direction: column;
  min-width: 250px;
  max-width: 100%;
  min-height: 340px;
  margin-bottom: 0.5rem;
  transition: box-shadow 0.2s, transform 0.18s;
  overflow: hidden; /* Impede que qualquer conteúdo ultrapasse o card */
}
.card:hover {
  box-shadow: 0 6px 32px #18f2b244, 0 0 0 2px #13b0fa44;
  transform: translateY(-4px) scale(1.013);
}
.card h2 {
  font-family: var(--tit);
  font-size: 1.22rem;
  letter-spacing: 1.2px;
  margin: 0 0 1.2rem 0;
  text-align: center;
  background: var(--highlight);
  background-clip: text;
  -webkit-background-clip: text;
  color: transparent;
  -webkit-text-fill-color: transparent;
  border-bottom: 2px solid var(--c3);
  padding-bottom: 0.5rem;
}

/* Campos de dados (inputs, textarea, select) ajustados */
input, textarea, select {
  width: 100%;
  max-width: 100%;     /* Nunca ultrapassa o card */
  border-radius: 0.9rem;
  background: var(--accent);
  color: var(--txt);
  border: none;
  padding: 0.75rem 1rem; /* Padding enxuto para manter dentro do card */
  margin: 0.25rem 0 0.7rem 0;
  font-size: 1rem;
  resize: vertical;
  font-family: var(--bod);
  outline: none;
  transition: border 0.18s, background 0.13s, box-shadow 0.2s;
  box-sizing: border-box;
  display: block;
}

input:focus, textarea:focus, select:focus {
  border: 2px solid #16e2c6;
  background: #203850;
  box-shadow: 0 0 0 2px #13b0fa44;
  transition: box-shadow 0.2s, border 0.2s;
}

/* Ajuste final de margem no último campo de cada form */
form > input:last-child,
form > textarea:last-child,
form > select:last-child {
  margin-bottom: 0.7rem !important;
}

@media (max-width: 800px) {
  .dashboard-grid .card {
    padding: 1rem 0.5rem 1rem 0.5rem;
    min-width: 94vw;
    max-width: 100vw;
  }
  input, textarea, select {
    font-size: 1rem;
    padding: 0.6rem 0.8rem;
    margin-bottom: 0.55rem;
  }
}

@media (max-width: 600px) {
  .dashboard-grid .card {
    padding: 0.5rem 0.1rem 0.8rem 0.1rem;
    min-width: 98vw;
    max-width: 100vw;
  }
  input, textarea, select {
    font-size: 0.99rem;
    padding: 0.48rem 0.65rem;
    margin-bottom: 0.48rem;
  }
}

/* Botões com gradiente neon */
.btn, .btn-remove {
  background: linear-gradient(90deg, #16e2c6 10%, #13b0fa 90%);
  color: #112130 !important;
  border: none;
  border-radius: 0.9rem;
  font-weight: bold;
  text-shadow: none;
  box-shadow: 0 2px 6px #16e2c622;
  transition: background 0.19s, color 0.13s, box-shadow 0.12s;
  text-align: center;
  min-width: 105px;
  font-family: var(--tit);
  font-size: 1rem;
  letter-spacing: 1px;
  padding: 0.48rem 1.15rem;
  margin: 0.16rem 0.2rem 0.16rem 0;
  cursor: pointer;
  display: inline-block;
}
.btn:hover, .btn:focus {
  background: linear-gradient(90deg, #13b0fa 10%, #16e2c6 90%);
  color: #fff !important;
  box-shadow: 0 3px 16px #13b0fa42;
}
.btn-remove {
  background: linear-gradient(90deg, #f24b86 10%, #13b0fa 90%);
  color: #fff !important;
}
.btn-remove:hover {
  background: linear-gradient(90deg, #13b0fa 10%, #f24b86 90%);
}

/* Tabelas e cabeçalho com gradiente */
table {
  width: 100%;
  border-collapse: collapse;
  background: #19314b;
  color: var(--txt);
  border-radius: 1rem;
  margin-bottom: 1rem;
  font-size: 0.99rem;
  overflow: hidden;
  box-shadow: 0 1px 6px #13b0fa11;
}
th, td {
  padding: 0.68rem 0.5rem;
  text-align: left;
  border-bottom: 1px solid #274169;
}
th {
  background: linear-gradient(90deg, #16e2c6 10%, #13b0fa 90%);
  color: #112130 !important;
  font-family: var(--tit);
  font-size: 1.04rem;
  letter-spacing: 0.5px;
  border-bottom: 2px solid #16e2c6;
}
tr:last-child td { border-bottom: none; }
.table-actions button {
  background: none;
  border: none;
  color: var(--c2);
  font-size: 1.13rem;
  margin: 0 0.18rem;
  cursor: pointer;
  transition: color 0.14s;
}
.table-actions button:hover { color: var(--c1); }

::-webkit-scrollbar {
  height: 7px;
  width: 9px;
  background: #17243b;
}
::-webkit-scrollbar-thumb {
  background: var(--c3);
  border-radius: 4px;
}

/* Botão do portal principal (opcional) */
.portal-acesso {
  background: var(--highlight);
  color: #16162a;
  border-radius: 1.5rem;
  font-family: var(--tit);
  text-align: center;
  font-size: 1.2rem;
  font-weight: bold;
  box-shadow: 0 2px 12px #0005;
  padding: 2.5rem 1rem;
  margin: 2rem auto 1rem auto;
  max-width: 700px;
  transition: transform 0.2s;
  cursor: pointer;
  text-decoration: none;
  letter-spacing: 1.2px;
  display: block;
}
.portal-acesso:hover { transform: scale(1.03); box-shadow: 0 4px 20px #00ffe766; }

  </style>
</head>
<body>
  <!-- Barra lateral fixa vertical com todos os atalhos -->
  <nav class="atalhos-lateral" aria-label="Atalhos Rápidos">
    <a href="https://classroom.google.com/" target="_blank" class="ataho-link" title="Google Classroom"><i class="fab fa-google"></i></a>
    <a href="https://meet.google.com/" target="_blank" class="ataho-link" title="Google Meet"><i class="fas fa-video"></i></a>
    <a href="https://drive.google.com/" target="_blank" class="ataho-link" title="Google Drive"><i class="fab fa-google-drive"></i></a>
    <a href="https://docs.google.com/" target="_blank" class="ataho-link" title="Google Docs"><i class="far fa-file-alt"></i></a>
    <a href="https://sheets.google.com/" target="_blank" class="ataho-link" title="Google Planilhas"><i class="fas fa-table"></i></a>
    <a href="https://slides.google.com/" target="_blank" class="ataho-link" title="Google Apresentações"><i class="fas fa-chalkboard"></i></a>
    <a href="https://fast.com/" target="_blank" class="ataho-link" title="Teste de Velocidade (Fast)"><i class="fas fa-laptop"></i></a>
    <a href="https://convertio.co/pt/" target="_blank" class="ataho-link" title="Convertio"><i class="fas fa-globe"></i></a>
    <a href="https://ravellsl.github.io/ferramenta-dev-links/" target="_blank" class="ataho-link" title="Dev Links"><i class="fas fa-code"></i></a>
    <a href="https://ravellsl.github.io/agentes-de-IA/" target="_blank" class="ataho-link" title="Agentes de IA"><i class="fas fa-robot"></i></a>
    <a href="https://www.videosmaller.com/pt/" target="_blank" class="ataho-link" title="Compressor de Vídeo"><i class="fas fa-exchange-alt"></i></a>
    <a href="https://ravellsl.github.io/ferramenta-busca-noticias/" target="_blank" class="ataho-link" title="Notícias"><i class="fas fa-newspaper"></i></a>
  </nav>
  <header>
    DASHBOARD CORPORATIVA | RS TECH
  </header>
  <div class="top-controls">
    <button class="btn-export" onclick="exportarDados()"><i class="fas fa-download"></i> Exportar Dados</button>
    <label class="btn-import" style="display:inline-block;cursor:pointer;">
      <i class="fas fa-upload"></i> Importar Dados
      <input type="file" id="importFile" accept=".json" style="display:none" onchange="importarDados(event)">
    </label>
  </div>
  <main class="dashboard-grid">
    <!-- Bloco de Notas -->
    <div class="card bloco-notas">
      <h2>Bloco de Notas</h2>
      <textarea id="blocoNotas" rows="5" placeholder="Digite suas anotações livres..."></textarea>
      <button class="btn" onclick="salvarBlocoNotas()">Salvar</button>
    </div>
    <!-- Diário de Classe -->
    <div class="card diario-classe">
      <h2>Diário de Classe</h2>
      <textarea id="diarioClasse" rows="5" placeholder="Descreva o que foi realizado em aula..."></textarea>
      <button class="btn" onclick="salvarDiarioClasse()">Salvar</button>
    </div>
    <!-- Anotações Rápidas -->
    <div class="card anotacoes-rapidas">
      <h2>Anotações Rápidas</h2>
      <form onsubmit="event.preventDefault(); adicionarAnotacao();">
        <input id="anotacaoInput" placeholder="Digite uma anotação rápida">
        <button class="btn" type="submit">Adicionar</button>
        <button class="btn" type="button" onclick="limparAnotacoes()">Limpar Tudo</button>
      </form>
      <table id="tabelaAnotacoes">
        <thead>
          <tr><th>Anotação</th><th style="width:70px;">Ações</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
    <!-- Cadastro de Alunos -->
    <div class="card cadastro-alunos">
      <h2>Cadastro de Alunos (AnyDesk)</h2>
      <form onsubmit="event.preventDefault(); adicionarAluno();">
        <input id="nomeAluno" placeholder="Nome do Aluno">
        <input id="anydeskAluno" placeholder="AnyDesk do Aluno">
        <button class="btn" type="submit" id="btnAlunoAdd">Cadastrar</button>
        <button class="btn" type="button" id="btnAlunoEdit" style="display:none;" onclick="confirmarEdicaoAluno()">Salvar Edição</button>
        <button class="btn" type="button" id="btnAlunoCancel" style="display:none;" onclick="cancelarEdicaoAluno()">Cancelar</button>
        <button class="btn" type="button" onclick="limparAlunos()">Limpar Tudo</button>
      </form>
      <table id="tabelaAlunos">
        <thead>
          <tr><th>Nome</th><th>AnyDesk</th><th style="width:80px;">Ações</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
    <!-- Tarefas Pendentes -->
    <div class="card tarefas-pendentes">
      <h2>Tarefas Pendentes</h2>
      <form onsubmit="event.preventDefault(); adicionarTarefa();">
        <input id="tarefaInput" placeholder="Adicionar nova tarefa">
        <button class="btn" type="submit" id="btnTarefaAdd">Adicionar</button>
        <button class="btn" type="button" id="btnTarefaEdit" style="display:none;" onclick="confirmarEdicaoTarefa()">Salvar Edição</button>
        <button class="btn" type="button" id="btnTarefaCancel" style="display:none;" onclick="cancelarEdicaoTarefa()">Cancelar</button>
        <button class="btn" type="button" onclick="limparTarefas()">Limpar Tudo</button>
      </form>
      <table id="tabelaTarefas">
        <thead>
          <tr><th>Tarefa</th><th>Status</th><th style="width:90px;">Ações</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
    <!-- Controle Financeiro -->
    <div class="card controle-financeiro">
      <h2>Controle Financeiro de Mensalidades</h2>
      <form onsubmit="event.preventDefault(); adicionarFinanceiro();">
        <input id="nomeFinanceiro" placeholder="Nome do Aluno">
        <input id="valorFinanceiro" type="number" placeholder="Valor (R$)">
        <select id="statusFinanceiro">
          <option value="Pago">Pago</option>
          <option value="Pendente">Pendente</option>
        </select>
        <button class="btn" type="submit" id="btnFinAdd">Lançar</button>
        <button class="btn" type="button" id="btnFinEdit" style="display:none;" onclick="confirmarEdicaoFinanceiro()">Salvar Edição</button>
        <button class="btn" type="button" id="btnFinCancel" style="display:none;" onclick="cancelarEdicaoFinanceiro()">Cancelar</button>
        <button class="btn" type="button" onclick="limparFinanceiro()">Limpar Tudo</button>
      </form>
      <table id="tabelaFinanceiro">
        <thead>
          <tr><th>Nome</th><th>Valor</th><th>Status</th><th style="width:90px;">Ações</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </main>
  <a class="portal-acesso" href="https://ravellsl.github.io/rstech/" target="_blank">
    <i class="fas fa-external-link-alt"></i> ACESSO AO PORTAL PRINCIPAL
  </a>
  <script>
    // BLOCO DE NOTAS E DIÁRIO DE CLASSE
    function salvarBlocoNotas() {
      localStorage.setItem('blocoNotas', document.getElementById('blocoNotas').value);
      alert('Bloco de Notas salvo com sucesso.');
    }
    document.getElementById('blocoNotas').value = localStorage.getItem('blocoNotas') || '';
    function salvarDiarioClasse() {
      localStorage.setItem('diarioClasse', document.getElementById('diarioClasse').value);
      alert('Diário de Classe salvo.');
    }
    document.getElementById('diarioClasse').value = localStorage.getItem('diarioClasse') || '';
    // ANOTAÇÕES RÁPIDAS
    let anotacaoEditIdx = null;
    function adicionarAnotacao() {
      const val = document.getElementById('anotacaoInput').value.trim();
      if (!val) return;
      let anotacoes = JSON.parse(localStorage.getItem('anotacoesRapidas') || '[]');
      if (anotacaoEditIdx === null) {
        anotacoes.push(val);
      } else {
        anotacoes[anotacaoEditIdx] = val;
        anotacaoEditIdx = null;
        document.getElementById('btnTarefaAdd').style.display = '';
        document.getElementById('btnTarefaEdit').style.display = 'none';
        document.getElementById('btnTarefaCancel').style.display = 'none';
      }
      localStorage.setItem('anotacoesRapidas', JSON.stringify(anotacoes));
      listarAnotacoes();
      document.getElementById('anotacaoInput').value = '';
    }
    function editarAnotacao(idx) {
      let anotacoes = JSON.parse(localStorage.getItem('anotacoesRapidas') || '[]');
      document.getElementById('anotacaoInput').value = anotacoes[idx];
      anotacaoEditIdx = idx;
      document.getElementById('btnTarefaAdd').style.display = 'none';
      document.getElementById('btnTarefaEdit').style.display = '';
      document.getElementById('btnTarefaCancel').style.display = '';
    }
    function limparAnotacoes() {
      if (confirm("Limpar todas as anotações?")) {
        localStorage.removeItem('anotacoesRapidas');
        listarAnotacoes();
      }
    }
    function removerAnotacao(idx) {
      let anotacoes = JSON.parse(localStorage.getItem('anotacoesRapidas') || '[]');
      anotacoes.splice(idx,1);
      localStorage.setItem('anotacoesRapidas', JSON.stringify(anotacoes));
      listarAnotacoes();
    }
    function cancelarEdicaoAnotacao() {
      anotacaoEditIdx = null;
      document.getElementById('anotacaoInput').value = '';
      document.getElementById('btnTarefaAdd').style.display = '';
      document.getElementById('btnTarefaEdit').style.display = 'none';
      document.getElementById('btnTarefaCancel').style.display = 'none';
    }
    function listarAnotacoes() {
      let anotacoes = JSON.parse(localStorage.getItem('anotacoesRapidas') || '[]');
      let tbody = document.getElementById('tabelaAnotacoes').getElementsByTagName('tbody')[0];
      tbody.innerHTML = '';
      anotacoes.forEach((a, idx) => {
        tbody.innerHTML += `
          <tr>
            <td>${a}</td>
            <td class="table-actions">
              <button onclick="editarAnotacao(${idx})" title="Editar"><i class="fas fa-edit"></i></button>
              <button onclick="removerAnotacao(${idx})" title="Remover"><i class="fas fa-trash"></i></button>
            </td>
          </tr>`;
      });
      cancelarEdicaoAnotacao();
    }
    listarAnotacoes();
    // CADASTRO DE ALUNOS
    let alunoEditIdx = null;
    function adicionarAluno() {
      const nome = document.getElementById('nomeAluno').value.trim();
      const anydesk = document.getElementById('anydeskAluno').value.trim();
      if (!nome || !anydesk) { alert('Preencha ambos os campos.'); return; }
      let lista = JSON.parse(localStorage.getItem('alunosAnyDesk') || '[]');
      if (alunoEditIdx === null) {
        lista.push({nome, anydesk});
      } else {
        lista[alunoEditIdx] = {nome, anydesk};
        alunoEditIdx = null;
        document.getElementById('btnAlunoAdd').style.display = '';
        document.getElementById('btnAlunoEdit').style.display = 'none';
        document.getElementById('btnAlunoCancel').style.display = 'none';
      }
      localStorage.setItem('alunosAnyDesk', JSON.stringify(lista));
      listarAlunos();
      document.getElementById('nomeAluno').value = '';
      document.getElementById('anydeskAluno').value = '';
    }
    function editarAluno(idx) {
      let lista = JSON.parse(localStorage.getItem('alunosAnyDesk') || '[]');
      document.getElementById('nomeAluno').value = lista[idx].nome;
      document.getElementById('anydeskAluno').value = lista[idx].anydesk;
      alunoEditIdx = idx;
      document.getElementById('btnAlunoAdd').style.display = 'none';
      document.getElementById('btnAlunoEdit').style.display = '';
      document.getElementById('btnAlunoCancel').style.display = '';
    }
    function confirmarEdicaoAluno() { adicionarAluno(); }
    function cancelarEdicaoAluno() {
      alunoEditIdx = null;
      document.getElementById('nomeAluno').value = '';
      document.getElementById('anydeskAluno').value = '';
      document.getElementById('btnAlunoAdd').style.display = '';
      document.getElementById('btnAlunoEdit').style.display = 'none';
      document.getElementById('btnAlunoCancel').style.display = 'none';
    }
    function limparAlunos() {
      if (confirm("Limpar todos os alunos?")) {
        localStorage.removeItem('alunosAnyDesk');
        listarAlunos();
      }
    }
    function removerAluno(idx) {
      let lista = JSON.parse(localStorage.getItem('alunosAnyDesk') || '[]');
      lista.splice(idx,1);
      localStorage.setItem('alunosAnyDesk', JSON.stringify(lista));
      listarAlunos();
    }
    function listarAlunos() {
      let lista = JSON.parse(localStorage.getItem('alunosAnyDesk') || '[]');
      let tbody = document.getElementById('tabelaAlunos').getElementsByTagName('tbody')[0];
      tbody.innerHTML = '';
      lista.forEach((a, idx) => {
        tbody.innerHTML += `
          <tr>
            <td>${a.nome}</td>
            <td>${a.anydesk}</td>
            <td class="table-actions">
              <button onclick="editarAluno(${idx})" title="Editar"><i class="fas fa-edit"></i></button>
              <button onclick="removerAluno(${idx})" title="Remover"><i class="fas fa-trash"></i></button>
            </td>
          </tr>`;
      });
      cancelarEdicaoAluno();
    }
    listarAlunos();
    // TAREFAS PENDENTES
    let tarefaEditIdx = null;
    function adicionarTarefa() {
      const val = document.getElementById('tarefaInput').value.trim();
      if (!val) return;
      let tarefas = JSON.parse(localStorage.getItem('tarefasPendentes') || '[]');
      if (tarefaEditIdx === null) {
        tarefas.push({tarefa: val, done: false});
      } else {
        tarefas[tarefaEditIdx].tarefa = val;
        tarefaEditIdx = null;
        document.getElementById('btnTarefaAdd').style.display = '';
        document.getElementById('btnTarefaEdit').style.display = 'none';
        document.getElementById('btnTarefaCancel').style.display = 'none';
      }
      localStorage.setItem('tarefasPendentes', JSON.stringify(tarefas));
      listarTarefas();
      document.getElementById('tarefaInput').value = '';
    }
    function editarTarefa(idx) {
      let tarefas = JSON.parse(localStorage.getItem('tarefasPendentes') || '[]');
      document.getElementById('tarefaInput').value = tarefas[idx].tarefa;
      tarefaEditIdx = idx;
      document.getElementById('btnTarefaAdd').style.display = 'none';
      document.getElementById('btnTarefaEdit').style.display = '';
      document.getElementById('btnTarefaCancel').style.display = '';
    }
    function confirmarEdicaoTarefa() { adicionarTarefa(); }
    function cancelarEdicaoTarefa() {
      tarefaEditIdx = null;
      document.getElementById('tarefaInput').value = '';
      document.getElementById('btnTarefaAdd').style.display = '';
      document.getElementById('btnTarefaEdit').style.display = 'none';
      document.getElementById('btnTarefaCancel').style.display = 'none';
    }
    function limparTarefas() {
      if (confirm("Limpar todas as tarefas?")) {
        localStorage.removeItem('tarefasPendentes');
        listarTarefas();
      }
    }
    function removerTarefa(idx) {
      let tarefas = JSON.parse(localStorage.getItem('tarefasPendentes') || '[]');
      tarefas.splice(idx, 1);
      localStorage.setItem('tarefasPendentes', JSON.stringify(tarefas));
      listarTarefas();
    }
    function concluirTarefa(idx) {
      let tarefas = JSON.parse(localStorage.getItem('tarefasPendentes') || '[]');
      tarefas[idx].done = !tarefas[idx].done;
      localStorage.setItem('tarefasPendentes', JSON.stringify(tarefas));
      listarTarefas();
    }
    function listarTarefas() {
      let tarefas = JSON.parse(localStorage.getItem('tarefasPendentes') || '[]');
      let tbody = document.getElementById('tabelaTarefas').getElementsByTagName('tbody')[0];
      tbody.innerHTML = '';
      tarefas.forEach((t, idx) => {
        tbody.innerHTML += `
          <tr${t.done ? ' style="text-decoration:line-through;opacity:.6;"' : ''}>
            <td>${t.tarefa}</td>
            <td>
              <button onclick="concluirTarefa(${idx})" title="Concluir" style="color:var(--c4);background:none;border:none;font-size:1.1rem;">
                <i class="fas fa-${t.done ? 'undo' : 'check'}"></i>
              </button>
            </td>
            <td class="table-actions">
              <button onclick="editarTarefa(${idx})" title="Editar"><i class="fas fa-edit"></i></button>
              <button onclick="removerTarefa(${idx})" title="Remover"><i class="fas fa-trash"></i></button>
            </td>
          </tr>`;
      });
      cancelarEdicaoTarefa();
    }
    listarTarefas();
    // CONTROLE FINANCEIRO
    let finEditIdx = null;
    function adicionarFinanceiro() {
      const nome = document.getElementById('nomeFinanceiro').value.trim();
      const valor = document.getElementById('valorFinanceiro').value.trim();
      const status = document.getElementById('statusFinanceiro').value;
      if (!nome || !valor) { alert('Preencha nome e valor.'); return; }
      let lista = JSON.parse(localStorage.getItem('controleFinanceiro') || '[]');
      if (finEditIdx === null) {
        lista.push({nome, valor, status});
      } else {
        lista[finEditIdx] = {nome, valor, status};
        finEditIdx = null;
        document.getElementById('btnFinAdd').style.display = '';
        document.getElementById('btnFinEdit').style.display = 'none';
        document.getElementById('btnFinCancel').style.display = 'none';
      }
      localStorage.setItem('controleFinanceiro', JSON.stringify(lista));
      listarFinanceiro();
      document.getElementById('nomeFinanceiro').value = '';
      document.getElementById('valorFinanceiro').value = '';
    }
    function editarFinanceiro(idx) {
      let lista = JSON.parse(localStorage.getItem('controleFinanceiro') || '[]');
      document.getElementById('nomeFinanceiro').value = lista[idx].nome;
      document.getElementById('valorFinanceiro').value = lista[idx].valor;
      document.getElementById('statusFinanceiro').value = lista[idx].status;
      finEditIdx = idx;
      document.getElementById('btnFinAdd').style.display = 'none';
      document.getElementById('btnFinEdit').style.display = '';
      document.getElementById('btnFinCancel').style.display = '';
    }
    function confirmarEdicaoFinanceiro() { adicionarFinanceiro(); }
    function cancelarEdicaoFinanceiro() {
      finEditIdx = null;
      document.getElementById('nomeFinanceiro').value = '';
      document.getElementById('valorFinanceiro').value = '';
      document.getElementById('statusFinanceiro').value = 'Pago';
      document.getElementById('btnFinAdd').style.display = '';
      document.getElementById('btnFinEdit').style.display = 'none';
      document.getElementById('btnFinCancel').style.display = 'none';
    }
    function limparFinanceiro() {
      if (confirm("Limpar todos os dados financeiros?")) {
        localStorage.removeItem('controleFinanceiro');
        listarFinanceiro();
      }
    }
    function removerFinanceiro(idx) {
      let lista = JSON.parse(localStorage.getItem('controleFinanceiro') || '[]');
      lista.splice(idx,1);
      localStorage.setItem('controleFinanceiro', JSON.stringify(lista));
      listarFinanceiro();
    }
    function listarFinanceiro() {
      let lista = JSON.parse(localStorage.getItem('controleFinanceiro') || '[]');
      let tbody = document.getElementById('tabelaFinanceiro').getElementsByTagName('tbody')[0];
      tbody.innerHTML = '';
      lista.forEach((f, idx) => {
        tbody.innerHTML += `
          <tr>
            <td>${f.nome}</td>
            <td>R$ ${f.valor}</td>
            <td>${f.status}</td>
            <td class="table-actions">
              <button onclick="editarFinanceiro(${idx})" title="Editar"><i class="fas fa-edit"></i></button>
              <button onclick="removerFinanceiro(${idx})" title="Remover"><i class="fas fa-trash"></i></button>
            </td>
          </tr>`;
      });
      cancelarEdicaoFinanceiro();
    }
    listarFinanceiro();
    // EXPORTAÇÃO / IMPORTAÇÃO
    function exportarDados() {
      const dados = {
        blocoNotas: localStorage.getItem('blocoNotas') || '',
        diarioClasse: localStorage.getItem('diarioClasse') || '',
        alunosAnyDesk: localStorage.getItem('alunosAnyDesk') || '[]',
        tarefasPendentes: localStorage.getItem('tarefasPendentes') || '[]',
        anotacoesRapidas: localStorage.getItem('anotacoesRapidas') || '[]',
        controleFinanceiro: localStorage.getItem('controleFinanceiro') || '[]'
      };
      const blob = new Blob([JSON.stringify(dados, null, 2)], {type: "application/json"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "dashboard_rs_tech_backup.json";
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }
    function importarDados(event) {
      const file = event.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const dados = JSON.parse(e.target.result);
          if (typeof dados !== "object") throw new Error("Formato inválido!");
          if ("blocoNotas" in dados) localStorage.setItem('blocoNotas', dados.blocoNotas);
          if ("diarioClasse" in dados) localStorage.setItem('diarioClasse', dados.diarioClasse);
          if ("alunosAnyDesk" in dados) localStorage.setItem('alunosAnyDesk', dados.alunosAnyDesk);
          if ("tarefasPendentes" in dados) localStorage.setItem('tarefasPendentes', dados.tarefasPendentes);
          if ("anotacoesRapidas" in dados) localStorage.setItem('anotacoesRapidas', dados.anotacoesRapidas);
          if ("controleFinanceiro" in dados) localStorage.setItem('controleFinanceiro', dados.controleFinanceiro);
          document.getElementById('blocoNotas').value = localStorage.getItem('blocoNotas') || '';
          document.getElementById('diarioClasse').value = localStorage.getItem('diarioClasse') || '';
          listarAlunos(); listarTarefas(); listarAnotacoes(); listarFinanceiro();
          alert("Dados importados com sucesso!");
        } catch(e) {
          alert("Falha na importação: " + e.message);
        }
      };
      reader.readAsText(file);
      event.target.value = "";
    }
  </script>
</body>
</html>
